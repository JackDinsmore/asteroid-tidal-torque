(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13875,        377]
NotebookOptionsPosition[     12763,        350]
NotebookOutlinePosition[     13154,        366]
CellTagsIndexPosition[     13111,        363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Ylm", "[", 
   RowBox[{"l_", ",", "m_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"LegendreP", "[", 
    RowBox[{"l", ",", "m", ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{"I", " ", "m", " ", "\[Phi]"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "^", "m"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rlm", "[", 
   RowBox[{"l_", ",", "m_", ",", "r_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "^", "m"}], 
   FractionBox[
    RowBox[{"r", "^", "l"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"l", "+", "m"}], ")"}], "!"}]], " ", 
   RowBox[{"Ylm", "[", 
    RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Slm", "[", 
   RowBox[{"l_", ",", "m_", ",", "r_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "^", "m"}], 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"l", "-", "m"}], ")"}], "!"}], 
    RowBox[{"r", "^", 
     RowBox[{"(", 
      RowBox[{"l", "+", "1"}], ")"}]}]], " ", 
   RowBox[{"Ylm", "[", 
    RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8342469675053377`*^9, 3.834247080262828*^9}, {
  3.834248657073969*^9, 3.834248660827875*^9}, {3.834675405544038*^9, 
  3.834675407632064*^9}, {3.834675608960848*^9, 3.834675612217873*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"d503f4e9-40b4-49d1-afc5-d02482ba5a7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lp", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mp", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xt", "=", "0.872"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yt", "=", "0.9048"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zt", "=", "0.2253"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dist", "=", "19.1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.834248631220048*^9, 3.834248648186472*^9}, {
   3.834249973755044*^9, 3.8342499739345207`*^9}, {3.834250085043805*^9, 
   3.834250093478389*^9}, {3.834250227453079*^9, 3.83425026267836*^9}, {
   3.834250537139941*^9, 3.8342505498907747`*^9}, 3.834251355998424*^9, {
   3.8342518787117968`*^9, 3.834251887145637*^9}, {3.834493008002061*^9, 
   3.834493008832535*^9}, {3.834671389960248*^9, 3.834671390103436*^9}, 
   3.8346723208155947`*^9, 3.834672362609406*^9, {3.834674855214727*^9, 
   3.8346748573158484`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"dadf5bf0-f4ea-4fc8-b2f4-991b922cef54"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rfunc", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xg", ",", " ", "yg", ",", " ", "zg"}], "}"}], ",", 
     RowBox[{"Grad", "[", 
      RowBox[{
       RowBox[{"Rlm", "[", 
        RowBox[{"lp", ",", "mp", ",", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"xg", "^", "2"}], "+", 
           RowBox[{"yg", "^", "2"}], "+", 
           RowBox[{"zg", "^", "2"}]}], "]"}], ",", 
         RowBox[{"ArcCos", "[", 
          FractionBox["zg", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"xg", "^", "2"}], "+", 
             RowBox[{"yg", "^", "2"}], "+", 
             RowBox[{"zg", "^", "2"}]}], "]"}]], "]"}], ",", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"xg", ",", "yg"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"xg", ",", "yg", ",", "zg"}], "}"}]}], "]"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xg", "->", "x"}], ",", 
     RowBox[{"yg", "->", "y"}], ",", 
     RowBox[{"zg", "->", "z"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"try", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"I", ",", "1", ",", "0"}], "}"}], 
      RowBox[{"(", 
       RowBox[{"lp", "-", "mp", "+", "1"}], ")"}], " ", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"Rlm", "[", 
        RowBox[{"lp", ",", 
         RowBox[{"mp", "-", "1"}], ",", " ", "r", ",", "\[Theta]", ",", 
         "\[Phi]"}], "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"I", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], 
      RowBox[{"(", 
       RowBox[{"lp", "+", "mp", "+", "1"}], ")"}], 
      RowBox[{"Conjugate", "[", 
       RowBox[{"Rlm", "[", 
        RowBox[{"lp", ",", 
         RowBox[{"mp", "+", "1"}], ",", " ", "r", ",", "\[Theta]", ",", 
         "\[Phi]"}], "]"}], "]"}]}], "+", " ", 
     RowBox[{"2", "mp", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "I"}], "}"}], " ", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"Rlm", "[", 
        RowBox[{
        "lp", ",", "mp", ",", " ", "r", ",", "\[Theta]", ",", "\[Phi]"}], 
        "]"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{"try", "[", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"xt", "^", "2"}], "+", 
        RowBox[{"yt", "^", "2"}], "+", 
        RowBox[{"zt", "^", "2"}]}], "]"}], ",", 
      RowBox[{"ArcCos", "[", 
       FractionBox["zt", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"xt", "^", "2"}], "+", 
          RowBox[{"yt", "^", "2"}], "+", 
          RowBox[{"zt", "^", "2"}]}], "]"}]], "]"}], ",", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"xt", ",", "yt"}], "]"}]}], "]"}], "]"}], "-", 
   "\[IndentingNewLine]", 
   RowBox[{"Conjugate", "[", 
    RowBox[{"N", "[", 
     RowBox[{"Rfunc", "[", 
      RowBox[{"xt", ",", "yt", ",", "zt"}], "]"}], "]"}], "]"}]}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.834248555816676*^9, 3.834248626362545*^9}, {
   3.8342486632105618`*^9, 3.8342487930761757`*^9}, {3.834248938812729*^9, 
   3.8342489527498903`*^9}, {3.834248997110865*^9, 3.8342489997910013`*^9}, {
   3.834249389857883*^9, 3.834249390778157*^9}, 3.834249565005879*^9, {
   3.834249732025084*^9, 3.834249757460101*^9}, {3.8342504023986073`*^9, 
   3.834250403722035*^9}, {3.834250554126601*^9, 3.8342505556276712`*^9}, {
   3.834251379074843*^9, 3.834251386255053*^9}, {3.83425179330151*^9, 
   3.834251824938047*^9}, {3.834670533634489*^9, 3.834670538145952*^9}, {
   3.834670628131185*^9, 3.834670637139007*^9}, {3.834670827285243*^9, 
   3.834670896124867*^9}, {3.834671203447338*^9, 3.834671299063065*^9}, {
   3.834671402953004*^9, 3.834671444215876*^9}, {3.834671479978547*^9, 
   3.834671484984853*^9}, {3.8346716157154837`*^9, 3.83467166652367*^9}, {
   3.834671786876088*^9, 3.834671812421343*^9}, {3.834671862620831*^9, 
   3.834671899283258*^9}, {3.834672016950107*^9, 3.8346720409163923`*^9}, {
   3.8346721397422113`*^9, 3.834672148333037*^9}, {3.834673974496292*^9, 
   3.834674004049382*^9}, 3.834674043361455*^9, {3.834675090887265*^9, 
   3.834675096071764*^9}, {3.834759565577087*^9, 3.8347595723719263`*^9}, {
   3.834759631429438*^9, 3.83475964545609*^9}, {3.834759684701311*^9, 
   3.8347597268901854`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"ef7ef425-173c-4d9d-be8b-668ddb826fc8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"2.3852447794681098`*^-18", "+", 
        RowBox[{"4.336808689942018`*^-19", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "1.0842021724855044`*^-18"}], "-", 
        RowBox[{"1.734723475976807`*^-18", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{
        RowBox[{"-", "6.505213034913027`*^-19"}], "+", 
        RowBox[{"6.505213034913027`*^-19", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.834673900460866*^9, {3.834673976660488*^9, 3.834674004272965*^9}, {
   3.834674039226239*^9, 3.834674044364705*^9}, {3.834675081438246*^9, 
   3.834675096492845*^9}, 3.8346756263276653`*^9, {3.8347595685482473`*^9, 
   3.834759601341507*^9}, {3.83475963307817*^9, 3.834759636116268*^9}, {
   3.834759693711926*^9, 3.834759727319626*^9}},
 CellLabel->
  "Out[120]//MatrixForm=",ExpressionUUID->"899688eb-61f5-4489-88c1-\
6ec15da03e09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Translation", "*)"}], "\[IndentingNewLine]", " ", 
  RowBox[{"Slm", "[", 
   RowBox[{"lp", ",", "mp", ",", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"xt", "^", "2"}], "+", 
      RowBox[{"yt", "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"zt", "-", "dist"}], ")"}], "^", "2"}]}], "]"}], ",", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"zt", "-", "dist"}], 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"xt", "^", "2"}], "+", 
        RowBox[{"yt", "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zt", "-", "dist"}], ")"}], "^", "2"}]}], "]"}]], "]"}], 
    ",", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"xt", ",", "yt"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.834254228603594*^9, 3.834254303618379*^9}, 
   3.8342543876619062`*^9, 3.834254483764771*^9, {3.834759585483581*^9, 
   3.83475958648355*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"4531919a-cd4a-425d-bc14-51e4f159e9e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1.8895371966457582`*^-9"}], "+", 
  RowBox[{"1.6910616074119757`*^-9", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.834254304380603*^9, 3.834254388002586*^9, {3.834254480759325*^9, 
   3.8342544841235037`*^9}, 3.834672328216915*^9, 3.8346723682903547`*^9, 
   3.834674863391573*^9, {3.8347595874781218`*^9, 3.834759611646364*^9}},
 CellLabel->"Out[92]=",ExpressionUUID->"fe29792b-0dc6-4714-80e7-dfb5cf881c9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", "lp"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], "^", "mp"}], " ", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Rlm", "[", 
      RowBox[{"ls", ",", "mp", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"xt", "^", "2"}], "+", 
         RowBox[{"yt", "^", "2"}], "+", 
         RowBox[{"zt", "^", "2"}]}], "]"}], ",", 
       RowBox[{"ArcCos", "[", 
        FractionBox["zt", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"xt", "^", "2"}], "+", 
           RowBox[{"yt", "^", "2"}], "+", 
           RowBox[{"zt", "^", "2"}]}], "]"}]], "]"}], ",", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"xt", ",", "yt"}], "]"}]}], "]"}], 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"lp", "+", "ls"}], ")"}], "!"}], 
      RowBox[{"dist", "^", 
       RowBox[{"(", 
        RowBox[{"lp", "+", "ls", "+", "1"}], ")"}]}]]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"ls", ",", 
      RowBox[{"Abs", "[", "mp", "]"}], ",", "100"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.834254323179454*^9, 3.834254476932529*^9}, {
  3.83475958974937*^9, 3.834759591558984*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"09734475-7991-41d6-a853-077e059762c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1.889537196645839`*^-9"}], "+", 
  RowBox[{"1.6910616074120477`*^-9", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.834254468200906*^9, 3.8342544772093*^9}, 
   3.834672330646143*^9, 3.834672370363719*^9, 3.8346748652866297`*^9, {
   3.83475959192388*^9, 3.834759615647377*^9}},
 CellLabel->"Out[93]=",ExpressionUUID->"72561e28-b374-4a04-83fc-d63df00eb0e7"]
}, Open  ]]
},
WindowSize->{693., 768.75},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c62e9411-f9c0-46aa-a31f-cbdde572c2f4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1696, 50, 109, "Input",ExpressionUUID->"d503f4e9-40b4-49d1-afc5-d02482ba5a7a"],
Cell[2257, 72, 1050, 21, 133, "Input",ExpressionUUID->"dadf5bf0-f4ea-4fc8-b2f4-991b922cef54"],
Cell[CellGroupData[{
Cell[3332, 97, 4697, 116, 329, "Input",ExpressionUUID->"ef7ef425-173c-4d9d-be8b-668ddb826fc8"],
Cell[8032, 215, 1383, 35, 85, "Output",ExpressionUUID->"899688eb-61f5-4489-88c1-6ec15da03e09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9452, 255, 1035, 28, 97, "Input",ExpressionUUID->"4531919a-cd4a-425d-bc14-51e4f159e9e7"],
Cell[10490, 285, 465, 8, 33, "Output",ExpressionUUID->"fe29792b-0dc6-4714-80e7-dfb5cf881c9b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10992, 298, 1342, 40, 109, "Input",ExpressionUUID->"09734475-7991-41d6-a853-077e059762c1"],
Cell[12337, 340, 410, 7, 33, "Output",ExpressionUUID->"72561e28-b374-4a04-83fc-d63df00eb0e7"]
}, Open  ]]
}
]
*)

