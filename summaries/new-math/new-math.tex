\documentclass[aps,twocolumn,secnumarabic,balancelastpage,amsmath,amssymb,nofootinbib,floatfix]{revtex4-1}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\usepackage{graphicx}      % tools for importing graphics
%\usepackage{lgrind}        % convert program code listings to a form
                            % includable in a LaTeX document
%\usepackage{xcolor}        % produces boxes or entire pages with
                            % colored backgrounds
%\usepackage{longtable}     % helps with long table options
%\usepackage{epsf}          % old package handles encapsulated postscript issues
\usepackage{bm}            % special bold-math package. usge: \bm{mathsymbol}
\usepackage{subcaption}
%\usepackage{asymptote}     % For typesetting of mathematical illustrations
%\usepackage{thumbpdf}
\usepackage[colorlinks=true]{hyperref}  % this package should be added after
                                        % all others.
                                        % usage: \url{http://web.mit.edu/8.13}
\usepackage{wasysym}

\begin{document}
\title{New math derivation}
\author{Jack Dinsmore, Julien de Wit}
\email{jtdinsmo@mit.edu}
\date{\today}
\affiliation{MIT Department of Physics}

\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\parens}[1]{\left( #1 \right)}
\newcommand{\brackets}[1]{\left[ #1 \right]}
\newcommand{\comment}[1]{\textcolor{red}{\emph{ #1 }}}
\newcommand{\x}{\bm{\hat x}}
\newcommand{\y}{\bm{\hat y}}
\newcommand{\z}{\bm{\hat z}}
\newcommand{\J}{\mathcal{J}}
\newcommand{\K}{\mathcal{K}}
\newcommand{\R}{\mathcal{R}}





\begin{abstract}
    The purpose of this summary is to derive the math governing the way an asteroid reacts to a non-point source. It was motivated by the discovery that, under the assumption of a gravitating point source and a small asteroid, the tidal torque can be written in terms of components of the moment of inertia, which means inference is limited to the six components of the inertia matrix. By violating these assumptions and considering other effects (oblateness, etc.), we can break the degeneracy.
\end{abstract}

\maketitle


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Definitions}
Please see \href{https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.56.5257&rep=rep1&type=pdf}{info on spherical harmonics}
$$P_{lm}=\frac{1}{2^ll!}(1-t^2)^{m/2} \frac{d^{l+m}}{dl^{l+m}}(t^2-1)^l$$
$$Y_{lm}(\theta, \phi) = P_{lm}(\cos\theta)e^{im\phi}$$
$$\bar Y_{lm}(\theta, \phi) = (-1)^m \sqrt{\frac{2l+1}{4\pi}\frac{(l-m)!}{(l+m)!}} Y_{lm}(\theta, \phi)$$
$$R_{lm}(\bm r) = (-1)^m \frac{r^l}{(l+m)!}Y_{lm}(\bm r)$$
$$S_{lm}(\bm r) = (-1)^m \frac{(l-m)!}{r^{l+1}}Y_{lm}(\bm r)$$
We write $Y(\bm r)=Y(\hat{\bm r})$.

These definitions lead to several key facts. For $r' < r$,
\begin{equation}
\frac{1}{|\bm r - \bm r'|}=\sum_{lm}R_{lm}(\bm r')S^*_{lm}(\bm r).
\label{eqn:expansion}
\end{equation}
We also have a translation rule:
\begin{equation}
S_{lm}(\bm r' - \bm r)=(-1)^l\sum_{l'm'}R^*_{l'm'}(\bm r')S_{l+l',m+m'}(\bm r)
\label{eqn:trans}.
\end{equation}
Similarly, we have some gradient formulas that result in
\begin{equation}
\begin{aligned}
\bm r \times \nabla R_{lm}^*=&-\frac{1}{2}[(i\x + \y)(l-m+1)R^*_{l,m-1}\\
&+(i\x-\y)(l+m+1)R^*_{l,m+1}+2im\z R^*_{lm}].
\end{aligned}
\label{eqn:grad}
\end{equation}
Finally, we have the symmetry relations $R_{l,-m}=(-1)^mR_{lm}^*$, $S_{l,-m}=(-1)^mS_{lm}^*$.


\section{Linear law of motion}
We use Newton's law of gravity for the linear law of motion:
\begin{equation}
\ddot{\bm D} = \hat {\bm D} \frac{\mu}{D^2}
\label{eqn:linear-eom}
\end{equation}
where $\bm D$ points from the asteroid to the planet, and $\mu$ is the reduced mass of the system. We assume that the asteroid mass is so much smaller than the planet's mass that the difference between $\mu$ and the mass of the planet cannot be detected. The initial conditions for $\bm D$ should have large magnitude of $D$ and $\dot D$ greater than the escape velocity of the system.

\section{Angular law of motion}
Recall that angular momentum satisfies $ \dot{\bm L} = \bm \tau = \frac{d}{dt}(I \bm \omega)$,
where $I$ is the moment of inertia matrix. This equation is not easily simplified in general, but in a coordinate system fixed to the rotating body, we make use of the fact that $\dot I = 0$. Also,
$$\dot{\bm L} = \dot{\bm L}_\text{rot} + L_x \dot{\x} + L_y \dot{\y} + L_z \dot{\z},$$
where $\dot{\bm L}_\text{rot} = \dot L_x \x + \dot L_y \y + \dot L_z \z$. By considering $\bm\omega \parallel \z$, we see that
$$L_x \dot{\x} + L_y \dot{\y} + L_z \dot{\z} = \bm\omega \times \bm L,$$
and since this pattern is replicated for all axes, it must be generally true. Furthermore, $\dot{\bm L}_\text{rot} = \dot I_\text{rot} \bm \omega + I \dot{\bm \omega}_\text{rot}$, and since $\dot I_\text{rot} = 0$, we have
$$\bm \tau = I \dot{\bm \omega} + \bm\omega \times \bm L.$$
Here we have removed the rot subscript on $\dot{\bm \omega}$ because $\dot{\bm \omega} = \dot{\bm \omega}_\text{rot} + \omega \times \omega =  \dot{\bm \omega}_\text{rot}.$ Reversing to solve for $\dot{\bm \omega}$, we have
\begin{equation}
\dot{\bm \omega} = I^{-1}\parens{\bm \tau - \bm \omega \times (I \bm \omega)}.
\label{eqn:euler}
\end{equation}
Once again, this is valid only in a frame fixed to the body. The torque $\bm \tau$ will be calculated in the next section.

The initial conditions are that $\omega$ is initially parallel to the eigenvector of $I$ with the largest eigenvalue, to minimize energy. The norm and direction of $\omega$ is observed.

It will turn out that our equation for $\tau$ will invoke the use of $\bm D$ in the rotating frame. To track $\bm D$ in that frame, we need $\dot{\bm D}_\text{rot}$. To find it,
$$\dot{\bm D} = \dot{\bm D}_\text{rot} + \bm \omega \times \bm D$$
or
\begin{equation}
\dot{\bm D}_\text{rot} = \bm D \times \bm \omega + \hat{\bm D}.
\label{eqn:d-eom}
\end{equation}
where $\dot D$ is given by the evolution of equation \ref{eqn:linear-eom}

\section{Torque}
By definition, the differential torque on a small unit of mass $dm$ within an asteroid is $d\bm \tau = \bm r \times d\bm F$, where $\bm r$ points to $dm$ from the center of mass of the asteroid. In the regime where $d\bm F$ is constant, there is no tidal torque. But if $d\bm F$ is allowed to vary across the asteroid, we will get tidal torque as shown.

The differential force is $d\bm F = -dm \nabla_{\bm R} V(\bm R)$, where
$$V(\bm R) = -\int d^3 r' \frac{\rho_M(\bm r')}{|\bm r' - \bm R|}$$
is the gravitational potential field of the planet, and $\bm R = \bm r - \bm D$ points from $dm$ to the center of mass of the planet. Also, we have $\rho_M$ as the mass distribution of the planet. Expanding this potential field using equation \ref{eqn:expansion}, we get
$$V(\bm R) = -\sum_{lm}S^*_{lm}(\bm R)\int d^3 r' \rho_M(\bm r') R_{lm}(\bm r').$$
We introduce the useful symbol
\begin{equation}
\J_{lm} = \int d^3 r \rho_M(\bm r) R_{lm} (\bm r)
\label{eqn:jlm-def}
\end{equation}
and we have
\begin{equation}
V(\bm R) = -\sum_{lm} S^*_{lm} (\bm R) \J_{lm}.
\label{eqn:potential}
\end{equation}
Incidentally, since $R_{00} = 1$, we have that $\J_{00}$ is the total mass of the asteroid and $\mu = G \J_{00}$, which can be used to simplify equation \ref{eqn:linear-eom}.

The total torque on the asteroid can therefore be written as
\begin{equation}
\bm \tau = \int d^3 r \rho(\bm r) \bm r \times \nabla_{\bm R} \sum_{lm} S^*_{lm}(\bm R) \J_{lm}.
\label{eqn:first-torque}
\end{equation}
Here, $\rho(\bm r)$ is now the mass density of the asteroid. Since $\nabla_{\bm R} = \nabla_{\bm r}$, we will drop the subscript henceforth.

Note that the bounds of integration of equations \ref{eqn:jlm-def} and \ref{eqn:first-torque} can be chosen to be the surfaces of the bodies in question, or any surface encompassing the bodies. It will be useful in the future to imagine these bounds as spherically symmetrical.

We expand equation \ref{eqn:first-torque} using equation \ref{eqn:trans}:
\begin{equation*}
\begin{aligned}
\bm \tau = &\sum_{lm}(-1)^l\J_{lm}\sum_{l'm'}S_{l+l',m+m'}(\bm D) \\
&\int d^3 r \rho(\bm r) \bm r \times \nabla R^*_{l'm'}(\bm r).
\end{aligned}
\end{equation*}
Now we can move straight on to substitution equation \ref{eqn:grad}:
\begin{equation*}
\begin{aligned}
\bm \tau = &-\frac{1}{2}\sum_{lm}(-1)^l\J_{lm}\sum_{l'm'}S_{l+l',m+m'}(\bm D) \\
&\int d^3 r \rho(\bm r) [(i\x + \y)(l'-m'+1)R^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)R^*_{l',m'+1}(\bm r)+2im'\z R^*_{l'm'}(\bm r)].
\end{aligned}
\end{equation*}
By defining the new varialble
\begin{equation}
\K_{lm} = \int d^3 r \rho(\bm r) R_{lm} (\bm r),
\label{eqn:klm-def}
\end{equation}
we can simplify this to
\begin{equation*}
\begin{aligned}
\bm \tau = &-\frac{1}{2}\sum_{lm}(-1)^l\J_{lm}\sum_{l'm'}S_{l+l',m+m'}(\bm D) \\
&\bigg[(i\x + \y)(l'-m'+1)\K^*_{l',m'-1}\\
&+(i\x-\y)(l'+m'+1)\K^*_{l',m'+1}+2im'\z \K^*_{l'm'}\bigg].
\label{eqn:complex-torque}
\end{aligned}
\end{equation*}



\section{Proof of real-ness}
This equation had better be real. To prove it, let us combine the $\pm m'$ terms, leaving out the $m'=0$ term and using the subscript o (off-diagonal) to indicate its absence:
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\frac{1}{2}\sum_{lm}(-1)^l\J_{lm}\sum_{l'm'_+}\Bigg\{S_{l+l',m+m'}(\bm D) \\
&\int d^3 r \rho(\bm r) [(i\x + \y)(l'-m'+1)R^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)R^*_{l',m'+1}(\bm r)+2im'\z R^*_{l'm'}(\bm r)]\\
&S_{l+l',m-m'}(\bm D) \\
&\int d^3 r \rho(\bm r) [(i\x + \y)(l'+m'+1)R^*_{l',-m'-1}(\bm r)\\
&+(i\x-\y)(l'-m'+1)R^*_{l',-m'+1}(\bm r)-2im'\z R^*_{l',-m'}(\bm r)]\Bigg\}.
\end{aligned}
\end{equation*}
Using the symmetry rules for complex conjugates,
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\frac{1}{2}\sum_{lm}(-1)^l\J_{lm}\sum_{l'm'_+}\Bigg\{S_{l+l',m+m'}(\bm D) \\
&\int d^3 r \rho(\bm r) [(i\x + \y)(l'-m'+1)R^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)R^*_{l',m'+1}(\bm r)+2im'\z R^*_{l'm'}(\bm r)]\\
&S_{l+l',m-m'}(\bm D) \\
&(-1)^{m'}\int d^3 r \rho(\bm r) [-(i\x + \y)(l'+m'+1)R_{l',m'+1}(\bm r)\\
&-(i\x-\y)(l'-m'+1)R_{l',m'-1}(\bm r)-2im'\z R_{l',m'}(\bm r)]\Bigg\}.
\end{aligned}
\end{equation*}
Now we expand for $\pm m$ too:
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\frac{1}{2}\sum_{lm_+}(-1)^l \Bigg\{\J_{lm}\sum_{l'm'_+} \Bigg[S_{l+l',m+m'}(\bm D) \\
&\int d^3 r \rho(\bm r) [(i\x + \y)(l'-m'+1)R^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)R^*_{l',m'+1}(\bm r)+2im'\z R^*_{l'm'}(\bm r)]\\
&+S_{l+l',m-m'}(\bm D) \\
&(-1)^{m'}\int d^3 r \rho(\bm r) [-(i\x + \y)(l'+m'+1)R_{l',m'+1}(\bm r)\\
&-(i\x-\y)(l'-m'+1)R_{l',m'-1}(\bm r)-2im'\z R_{l',m'}(\bm r)]\Bigg]\\
&+ \J_{l,-m}\sum_{l'm'_+} \Bigg[S_{l+l',-m+m'}(\bm D) \\
&+\int d^3 r \rho(\bm r) [(i\x + \y)(l'-m'+1)R^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)R^*_{l',m'+1}(\bm r)+2im'\z R^*_{l'm'}(\bm r)]\\
&+S_{l+l',-m-m'}(\bm D) \\
&(-1)^{m'}\int d^3 r \rho(\bm r) [-(i\x + \y)(l'+m'+1)R_{l',m'+1}(\bm r)\\
&-(i\x-\y)(l'-m'+1)R_{l',m'-1}(\bm r)-2im'\z R_{l',m'}(\bm r)]\Bigg]\Bigg\}.
\end{aligned}
\end{equation*}
Let us introduce a new notation:
\begin{equation}
\K_{lm} = \int d^3 r \rho(\bm r) R_{lm} (\bm r)
\label{eqn:klm-def}
\end{equation}
which are the expansion coefficients of the potential of the asteroid. Then the above becomes
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\frac{1}{2}\sum_{lm_+}(-1)^l \Bigg\{\J_{lm}\sum_{l'm'_+} \Bigg[S_{l+l',m+m'}(\bm D) \\
&\bigg[(i\x + \y)(l'-m'+1)\K^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)K^*_{l',m'+1}(\bm r)+2im'\z \K^*_{l'm'}(\bm r)\bigg]\\
&+S_{l+l',m-m'}(\bm D) \\
&(-1)^{m'}\bigg[-(i\x + \y)(l'+m'+1)\K_{l',m'+1}(\bm r)\\
&-(i\x-\y)(l'-m'+1)\K_{l',m'-1}(\bm r)-2im'\z \K_{l',m'}(\bm r)\bigg]\Bigg]\\
&+ (-1)^m (-1)^{m+m'}\J_{l,m}^*\sum_{l'm'_+} \Bigg[S^*_{l+l',m-m'}(\bm D) \\
&\bigg[(i\x + \y)(l'-m'+1)\K^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)\K^*_{l',m'+1}(\bm r)+2im'\z \K^*_{l'm'}(\bm r)\bigg]\\
&+S^*_{l+l',m+m'}(\bm D) \\
&(-1)^{m'}\bigg[-(i\x + \y)(l'+m'+1)\K_{l',m'+1}(\bm r)\\
&-(i\x-\y)(l'-m'+1)\K_{l',m'-1}(\bm r)-2im'\z \K_{l',m'}(\bm r)\bigg]\Bigg]\Bigg\}.
\end{aligned}
\end{equation*}
which can be simplified as
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\frac{1}{2}\sum_{lm_+}\sum_{l'm'_+}(-1)^l \Bigg\{\J_{lm} \Bigg[S_{l+l',m+m'}(\bm D) \\
&\bigg[(i\x + \y)(l'-m'+1)\K^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)K^*_{l',m'+1}(\bm r)+2im'\z \K^*_{l'm'}(\bm r)\bigg]\\
&+S_{l+l',m-m'}(\bm D) \\
&(-1)^{m'}\bigg[-(i\x + \y)(l'+m'+1)\K_{l',m'+1}(\bm r)\\
&-(i\x-\y)(l'-m'+1)\K_{l',m'-1}(\bm r)-2im'\z \K_{l',m'}(\bm r)\bigg]\Bigg]\\
&+\J_{lm}^*\Bigg[S^*_{l+l',m+m'}(\bm D) \\
&\bigg[-(i\x-\y)(l'-m'+1)\K_{l',m'-1}(\bm r)\\
&-(i\x + \y)(l'+m'+1)\K_{l',m'+1}(\bm r)-2im'\z \K_{l',m'}(\bm r)\bigg]\Bigg]\\
&+(-1)^{m'}S^*_{l+l',m-m'}(\bm D) \\
&\bigg[(i\x-\y)(l'+m'+1)\K^*_{l',m'+1}(\bm r)\\
&+(i\x + \y)(l'-m'+1)\K^*_{l',m'-1}(\bm r)+2im'\z \K^*_{l'm'}(\bm r)\bigg]\Bigg\}
\end{aligned}
\end{equation*}
or
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\frac{1}{2}\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&(l'-m'+1)\bigg(\J_{lm}S_{l+l',m+m'}(\bm D)(i\x + \y)\K^*_{l',m'-1}\\
&-(-1)^{m'}\J_{lm}S_{l+l',m-m'}(\bm D)(i\x-\y)\K_{l',m'-1}\\
&-\J_{lm}^*S^*_{l+l',m+m'}(\bm D)\K_{l',m'-1}(i\x-\y)\\
&+(-1)^{m'}\J_{lm}^*S^*_{l+l',m-m'}(\bm D)(i\x + \y)\K^*_{l',m'-1}\bigg)\\
&+(l'+m'+1)\bigg(\J_{lm}S_{l+l',m+m'}(\bm D)(i\x-\y)\K^*_{l',m'+1}\\
&-(-1)^{m'}\J_{lm}S_{l+l',m-m'}(\bm D)(i\x + \y)\K_{l',m'+1}\\
&-\J_{lm}^*S^*_{l+l',m+m'}(\bm D)\K_{l',m'+1}(i\x + \y)\\
&+(-1)^{m'}\J_{lm}^*S^*_{l+l',m-m'}(\bm D)(i\x-\y)\K^*_{l',m'+1}\bigg)\\
&+2im'\z\bigg(\J_{lm}S_{l+l',m+m'}(\bm D)\K^*_{l'm'}\\
&-(-1)^{m'}\J_{lm}S_{l+l',m-m'}(\bm D)\K_{l'm'}\\
&-\J_{lm}^*S^*_{l+l',m+m'}(\bm D)\K_{l'm'}\\
&+(-1)^{m'}\J_{lm}^*S^*_{l+l',m-m'}(\bm D)\K^*_{l'm'}\bigg)\Bigg\}.
\end{aligned}
\end{equation*}
This can be written as follows
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\frac{1}{2}\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&(l'-m'+1)\bigg(\J_{lm}S_{l+l',m+m'}(\bm D)(i\x + \y)\K^*_{l',m'-1}\\
&+\J_{lm}^*S^*_{l+l',m+m'}(\bm D)\K_{l',m'-1}(-i\x+\y)\\
&-(-1)^{m'}\J_{lm}S_{l+l',m-m'}(\bm D)(i\x-\y)\K_{l',m'-1}\\
&-(-1)^{m'}\J_{lm}^*S^*_{l+l',m-m'}(\bm D)(-i\x - \y)\K^*_{l',m'-1}\bigg)\\
&+(l'+m'+1)\bigg(\J_{lm}S_{l+l',m+m'}(\bm D)(i\x-\y)\K^*_{l',m'+1}\\
&+\J_{lm}^*S^*_{l+l',m+m'}(\bm D)\K_{l',m'+1}(-i\x - \y)\\
&-(-1)^{m'}\J_{lm}S_{l+l',m-m'}(\bm D)(i\x + \y)\K_{l',m'+1}\\
&-(-1)^{m'}\J_{lm}^*S^*_{l+l',m-m'}(\bm D)(-i\x+\y)\K^*_{l',m'+1}\bigg)\\
&+2im'\z\bigg(\J_{lm}S_{l+l',m+m'}(\bm D)\K^*_{l'm'}\\
&-\J_{lm}^*S^*_{l+l',m+m'}(\bm D)\K_{l'm'}\\
&-(-1)^{m'}\J_{lm}S_{l+l',m-m'}(\bm D)\K_{l'm'}\\
&+(-1)^{m'}\J_{lm}^*S^*_{l+l',m-m'}(\bm D)\K^*_{l'm'}\bigg)\Bigg\},
\end{aligned}
\end{equation*}
or
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&+(l'-m'+1)\bigg(\Re\brackets{\J_{lm}S_{l+l',m+m'}(\bm D)(-i\x+\y)\K^*_{l',m'-1}}\\
&-(-1)^{m'}\Re\brackets{\J_{lm}S_{l+l',m-m'}(\bm D)(i\x-\y)\K_{l',m'-1}}\bigg)\\
&+(l'+m'+1)\bigg(\Re\brackets{\J_{lm}S_{l+l',m+m'}(\bm D)(i\x-\y)\K^*_{l',m'+1}}\\
&-(-1)^{m'}\Re\brackets{\J_{lm}S_{l+l',m-m'}(\bm D)(i\x + \y)\K_{l',m'+1}}\bigg)\\
&-2m'\z\bigg(\Im\brackets{\J_{lm}S_{l+l',m+m'}(\bm D)\K^*_{l'm'}}\\
&-(-1)^{m'}\Im\brackets{\J_{lm}S_{l+l',m-m'}(\bm D)\K_{l'm'}}\bigg)\Bigg\}.
\end{aligned}
\end{equation*}
Define
$$\J_{lml'm'}^\pm = \J_{lm} S_{l+l',m\pm m'}(\bm D)(\pm 1)^{m'+1}.$$
Then
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&+(l'-m'+1)\bigg(\Re\brackets{\J_{lml'm'}^+(-i\x+\y)\K^*_{l',m'-1}}\\
&+\Re\brackets{\J_{lml'm'}^-(i\x-\y)\K_{l',m'-1}}\bigg)\\
&+(l'+m'+1)\bigg(\Re\brackets{\J_{lml'm'}^+(i\x-\y)\K^*_{l',m'+1}}\\
&+\Re\brackets{\J_{lml'm'}^-(i\x + \y)\K_{l',m'+1}}\bigg)\\
&-2m'\z\bigg(\Im\brackets{\J_{lml'm'}^+\K^*_{l'm'}}+\Im\brackets{\J_{lml'm'}^-\K_{l'm'}}\bigg)\Bigg\}.
\end{aligned}
\end{equation*}
Further defining
\begin{equation}
\begin{aligned}
\chi_{lml'm'}^{\pm,s}& = \J_{lml'm'}^\pm \K^*_{l',m'+s}\\
&= (\pm 1)^{m'+1}S_{l+l',m\pm m'}(\bm D)\J_{lm} \K^*_{l',m'+s},
\end{aligned}
\label{eqn:chi}
\end{equation}
we get
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&+(l'-m'+1)\bigg(\Re\brackets{\chi_{lml'm'}^{+-}(i\x+\y)}\\
&+\Re\brackets{\chi_{lml'm'}^{--}(i\x-\y)}\bigg)\\
&+(l'+m'+1)\bigg(\Re\brackets{\chi_{lml'm'}^{++}(i\x-\y)}\\
&+\Re\brackets{\chi_{lml'm'}^{-+}(i\x + \y)}\bigg)\\
&-2m'\z\bigg(\Im\brackets{\chi_{lml'm'}^{+0}}+\Im\brackets{\chi_{lml'm'}^{-0}}\bigg)\Bigg\}
\end{aligned}
\end{equation*}
\comment{(Here I realized I made a mistake earlier; I took the complex conjugate of the top line and forgot to conjugate the vector term, so I do it here)}, or
\begin{equation*}
\begin{aligned}
\bm \tau_o = &-\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&+(l'-m'+1)\bigg(\Re\chi_{lml'm'}^{+-}\y - \Im\chi_{lml'm'}^{+-}\x\\
&-\Re\chi_{lml'm'}^{--}\y - \Im\chi_{lml'm'}^{--}\x \bigg)\\
&+(l'+m'+1)\bigg(-\Re\chi_{lml'm'}^{++}\y - \Im\chi_{lml'm'}^{++}\x\\
&+\Re\chi_{lml'm'}^{-+}\y - \Im\chi_{lml'm'}^{-+}\x\bigg)\\
&-2m'\z\bigg(\Im\chi_{lml'm'}^{+0}+\Im\chi_{lml'm'}^{-0}\bigg)\Bigg\}.
\end{aligned}
\end{equation*}
We can write this as
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&+(l'-m'+1)\bigg(\Im\chi_{lml'm'}^{+-}\x - \Re\chi_{lml'm'}^{+-}\y\\
&+\Re\chi_{lml'm'}^{--}\y + \Im\chi_{lml'm'}^{--}\x \bigg)\\
&+(l'+m'+1)\bigg(\Re\chi_{lml'm'}^{++}\y + \Im\chi_{lml'm'}^{++}\x\\
&\Im\chi_{lml'm'}^{-+}\x - \Re\chi_{lml'm'}^{-+}\y\bigg)\\
&+2m'\z\bigg(\Im\chi_{lml'm'}^{+0}+\Im\chi_{lml'm'}^{-0}\bigg)\Bigg\},
\end{aligned}
\end{equation*}
or, joining vectors,
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&\x \bigg((l'-m'+1)\Im\chi_{lml'm'}^{+-} + (l'-m'+1)\Im\chi_{lml'm'}^{--}\\
&+(l'+m'+1)\Im\chi_{lml'm'}^{++} + (l'+m'+1)\Im\chi_{lml'm'}^{-+}\bigg)\\
&+\y \bigg(-(l'-m'+1)\Re\chi_{lml'm'}^{+-} + (l'-m'+1)\Re\chi_{lml'm'}^{--}\\
&+(l'+m'+1)\Re\chi_{lml'm'}^{++} - (l'+m'+1)\Re\chi_{lml'm'}^{-+}\bigg)\\
&+2m'\z\bigg(\Im\chi_{lml'm'}^{+0}+\Im\chi_{lml'm'}^{-0}\bigg)\Bigg\}.
\end{aligned}
\end{equation*}
Finally,
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++}+ (l'-m'+1)\chi_{lml'm'}^{--}\\
&+ (l'-m'+1)\chi_{lml'm'}^{+-} + (l'+m'+1)\chi_{lml'm'}^{-+}\bigg)\\
&+\y \Re\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--} \\
&- (l'-m'+1)\chi_{lml'm'}^{+-} - (l'+m'+1)\chi_{lml'm'}^{-+}\bigg)\\
&+2m'\z\Im\bigg(\chi_{lml'm'}^{+0}+\chi_{lml'm'}^{-0}\bigg)\Bigg\}.
\end{aligned}
\end{equation*}

Note that
\begin{equation}
\begin{aligned}
\chi_{l,-m,l',m'}^{\pm,s} = &(\pm 1)^{m'+1}S_{l+l',-m\pm m'}(\bm D)\J_{l,-m} \K^*_{l',m'+s}\\
=&(-1)^s(\pm 1)^{m'+1}S^*_{l+l',m\mp m'}(\bm D)\J^*_{lm} \K_{l',-m'-s}\\
=&(-1)^s{\chi_{l,m,l',-m'}^{\pm,-s}}^*.
\end{aligned}
\label{eqn:chi}
\end{equation}
and
\begin{equation}
\begin{aligned}
\chi_{l,-m,l',-m'}^{\pm,s} = &(\pm 1)^{-m'+1}S_{l+l',-m\mp m'}(\bm D)\J_{l,-m} \K^*_{l',-m'+s}\\
=&(-1)^s(\pm 1)^{m'+1}S^*_{l+l',m\pm m'}(\bm D)\J^*_{lm} \K_{l',m'-s}\\
=&(-1)^s{\chi_{lml'm'}^{\pm,-s}}^*
\end{aligned}
\label{eqn:chi}
\end{equation}
so
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--}\\
&+ (l'-m'+1)\chi_{l,-m,l',-m'}^{++} + (l'+m'+1)\chi_{l,-m,l',-m'}^{--}\bigg)\\
&+\y \Re\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--} \\
&+ (l'-m'+1)\chi_{l,-m,l',-m'}^{++} + (l'+m'+1)\chi_{l,-m,l',-m'}^{--}\bigg)\\
&+2m'\z\Im\bigg(\chi_{lml'm'}^{+0}+\chi_{lml'm'}^{-0}\bigg)\Bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\sum_{lm_+}\sum_{l'm'_+}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--}\bigg)\\
&+\y \Re\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--}\bigg)\\
&+m'\z\Im\bigg(\chi_{lml'm'}^{+0}+\chi_{lml'm'}^{-0}\bigg)\Bigg\}\\
&+\sum_{lm_-}\sum_{l'm'_-}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--}\bigg)\\
&+\y \Re\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--}\bigg)\\
&+m'\z\Im\bigg(\chi_{lml'm'}^{+0}+\chi_{lml'm'}^{-0}\bigg)\Bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\parens{\sum_{lm_+}\sum_{l'm'_+}+\sum_{lm_-}\sum_{l'm'_-}}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--}\bigg)\\
&+\y \Re\bigg((l'+m'+1)\chi_{lml'm'}^{++} + (l'-m'+1)\chi_{lml'm'}^{--}\bigg)\\
&+m'\z\Im\bigg(\chi_{lml'm'}^{+0}+\chi_{lml'm'}^{-0}\bigg)\Bigg\}
\end{aligned}
\end{equation*}

\clearpage



Then consider
\begin{equation*}
\begin{aligned}
&\sum_{l,m\neq0}\sum_{l',m'\neq 0'}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} - (l'-m'+1)\chi_{lml'm'}^{+-}\bigg)
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
=&\sum_{l,m_+}\sum_{l',m'\neq 0'}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} - (l'-m'+1)\chi_{lml'm'}^{+-}\bigg)\\
&\x \Im\bigg((l'+m'+1)\chi_{l,m,l',-m'}^{+-} - (l'-m'+1)\chi_{l,m,l',-m'}^{++}\bigg)\\
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
=&\sum_{l,m_+}\sum_{l',m'_+}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} - (l'-m'+1)\chi_{lml'm'}^{+-}\bigg)\\
&+\x \Im\bigg((l'+m'+1)\chi_{l,m,l',-m'}^{+-} - (l'-m'+1)\chi_{l,m,l',-m'}^{++}\bigg)\\
&+\x \Im\bigg((l'-m'+1)\chi_{l,m,l',-m'}^{++} - (l'+m'+1)\chi_{l,m,l',-m'}^{+-}\bigg)\\
&+\x \Im\bigg((l'-m'+1)\chi_{lml'm'}^{+-} - (l'+m'+1)\chi_{lml'm'}^{++}\bigg)
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
=&\sum_{l,m_+}\sum_{l',m'_+}(-1)^l\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{lml'm'}^{++} - (l'-m'+1)\chi_{lml'm'}^{+-}\bigg)\\
&+\x \Im\bigg((l'+m'+1)\chi_{l,m,l',-m'}^{+-} - (l'-m'+1)\chi_{l,m,l',-m'}^{++}\bigg)\\
&+\x \Im\bigg((l'-m'+1)\chi_{l,m,l',-m'}^{++} - (l'+m'+1)\chi_{l,m,l',-m'}^{+-}\bigg)\\
&+\x \Im\bigg((l'-m'+1)\chi_{lml'm'}^{+-} - (l'+m'+1)\chi_{lml'm'}^{++}\bigg)
\end{aligned}
\end{equation*}



Now we want to compute the on-diagonal component of torque, which is where $m'=0$, and $m\in \mathbb{Z}.$ That's
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\frac{1}{2}\sum_{lm}(-1)^l\J_{lm}\sum_{l'}(l'+1)S_{l+l',m}(\bm D) \\
&[(i\x + \y)\K^*_{l',-1}+(i\x-\y)\K^*_{l',1}].
\end{aligned}
\end{equation*}
Now we combine $\pm m$,
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\frac{1}{2}\sum_{lm_+}(-1)^l\Bigg\{\J_{lm}\sum_{l'}(l'+1)S_{l+l',m}(\bm D) \\
&[(i\x + \y)\K^*_{l',-1}+(i\x-\y)\K^*_{l',1}]\\
& + \J_{l,-m}\sum_{l'}(l'+1)S_{l+l',-m}(\bm D) \\
& [(i\x + \y)\K^*_{l',-1}+(i\x-\y)\K^*_{l',1}]\Big\}\\
& - \frac{1}{2}\sum_{l}(-1)^l \J_{l0} \sum_{l'}(l'+1)S_{l+l',0}(\bm D)\\
& [(i\x + \y)\K^*_{l',-1} + (i\x - \y \K^*_{l',1})].
\end{aligned}
\end{equation*}
Note that
$$\chi_{lml'0}^{\pm,s} = \pm S_{l+l',m}(\bm D)\J_{lm} \K^*_{l',s},$$
so
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\frac{1}{2}\sum_{lm_+}(-1)^l\sum_{l'}(l'+1)\Bigg\{ \\
&[(-i\x - \y)\chi_{lml'0}^{--}+(i\x-\y)\chi_{lml'0}^{++}]\\
& + [(-i\x - \y){\chi_{lml'0}^{++}}^*+(i\x-\y){\chi_{lml'0}^{--}}^*]\Big\}\\
& - \frac{1}{2}\sum_{l}(-1)^l \sum_{l'}(l'+1)\\
& [(-i\x - \y)\chi_{l0l'0}^{--} + (i\x - \y)\chi_{l0l'0}^{++}].
\end{aligned}
\end{equation*}
Since $\chi_{l0l'0}^{--}={\chi_{l0l'0}^{++}}^*$, this simplifies as follows:
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{lm_+}(-1)^l\sum_{l'}(l'+1)\Big( \\
&\Re[(-i\x - \y)\chi_{lml'0}^{--}]+\Re[(i\x-\y)\chi_{lml'0}^{++}]\Big)\\
& - \sum_{l}(-1)^l \sum_{l'}(l'+1) \Re[(i\x - \y)\chi_{l0l'0}^{++}]
\end{aligned}
\end{equation*}
or
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{lm_+}(-1)^l\sum_{l'}(l'+1)\Bigg\{\\
&\parens{-\y\Re\chi_{lml'0}^{--} + \x\Im\chi_{lml'0}^{--}}\\
&+\parens{-\y\Re\chi_{lml'0}^{++}-\x\Im\chi_{lml'0}^{++}}\Bigg\}\\
& - \sum_{l}(-1)^l \sum_{l'}(l'+1) \parens{-\y\Re\chi_{l0l'0}^{++} - \x\Im\chi_{l0l'0}^{++}]}
\end{aligned}
\end{equation*}
which is
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{lm_+}(-1)^l\sum_{l'}(l'+1)\Bigg\{\\
&\x\Im\parens{\chi_{lml'0}^{--}-\chi_{lml'0}^{++}} -\y\Re\parens{\chi_{lml'0}^{++}+\chi_{lml'0}^{--}} \Bigg\}\\
& - \sum_{l}(-1)^l \sum_{l'}(l'+1) \parens{-\y\Re\chi_{l0l'0}^{++} - \x\Im\chi_{l0l'0}^{++}}.
\end{aligned}
\end{equation*}
We can also write this as
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{lm_+}(-1)^l\sum_{l'}(l'+1)\Bigg\{\\
&\x\Im\parens{\chi_{lml'0}^{--}+\chi_{lml'0}^{-+}} - \y\Re\parens{\chi_{lml'0}^{++} - \chi_{lml'0}^{+-}} \Bigg\}\\
& - \sum_{l}(-1)^l \sum_{l'}(l'+1) \parens{-\y\Re\chi_{l0l'0}^{++} - \x\Im\chi_{l0l'0}^{++}}
\end{aligned}
\end{equation*}
which is
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{lm_+}(-1)^l\sum_{l'}(l'+1)\Bigg\{\\
&\x\Im\parens{\chi_{lml'0}^{--}+\chi_{l,-m,l',0}^{--}} - \y\Re\parens{\chi_{lml'0}^{++} + \chi_{l,-m,l',0}^{++}} \Bigg\}\\
& + \sum_{l}(-1)^l \sum_{l'}(l'+1) \parens{\y\Re\chi_{l0l'0}^{++} + \x\Im\chi_{l0l'0}^{++}}
\end{aligned}
\end{equation*}
or
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{lm}(-1)^l\sum_{l'}(l'+1)\Bigg\{\x\Im\chi_{lml'0}^{--} - \y\Re\chi_{lml'0}^{++}\Bigg\}.
\end{aligned}
\end{equation*}
Note that the sum now extends over all $m$.

I forgot to add the case where $m=0$, $m'\neq 0$. So add this part:
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\frac{1}{2}\sum_{l}(-1)^l\J_{l0}\sum_{l',m'\neq 0}S_{l+l',m'}(\bm D) \\
&\int d^3 r \rho(\bm r) [(i\x + \y)(l'-m'+1)R^*_{l',m'-1}(\bm r)\\
&+(i\x-\y)(l'+m'+1)R^*_{l',m'+1}(\bm r)+2im'\z R^*_{l'm'}(\bm r)]
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\frac{1}{2}\sum_{l}(-1)^l\J_{l0}\sum_{l',m'_+}\Bigg\{ \\
&\bigg[(i\x + \y)(l'-m'+1)S_{l+l',m'}(\bm D)\K^*_{l',m'-1}\\
&+(i\x-\y)(l'+m'+1)S_{l+l',m'}(\bm D)\K^*_{l',m'+1}\\
&+2im'\z S_{l+l',m'}(\bm D)\K^*_{l'm'}\bigg]\\
&+\bigg[(i\x + \y)(l'+m'+1)S_{l+l',-m'}(\bm D)\K^*_{l',-m'-1}\\
&+(i\x-\y)(l'-m'+1)S_{l+l',-m'}(\bm D)\K^*_{l',-m'+1}\\
&-2im'\z S_{l+l',-m'}(\bm D)\K^*_{l'-m'}\bigg]\Bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\frac{1}{2}\sum_{l}(-1)^l\J_{l0}\sum_{l',m'_+}\Bigg\{ \\
&\bigg[(i\x + \y)(l'-m'+1)S_{l+l',m'}(\bm D)\K^*_{l',m'-1}\\
&+(i\x-\y)(l'+m'+1)S_{l+l',m'}(\bm D)\K^*_{l',m'+1}\\
&+2im'\z S_{l+l',m'}(\bm D)\K^*_{l'm'}\bigg]\\
&+\bigg[-(i\x + \y)(l'+m'+1)S^*_{l+l',m'}(\bm D)\K_{l',m'+1}\\
&-(i\x-\y)(l'-m'+1)S^*_{l+l',m'}(\bm D)\K_{l',m'-1}\\
&-2im'\z S^*_{l+l',m'}(\bm D)\K_{l'm'}\bigg]\Bigg\}
\end{aligned}
\end{equation*}


\begin{equation}
\begin{aligned}
\chi_{l0l'm'}^{\pm,s}&= (\pm 1)^{m'+1}S_{l+l',\pm m'}(\bm D)\J_{l0} \K^*_{l',m'+s},\\
\end{aligned}
\label{eqn:chi}
\end{equation}

\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\frac{1}{2}\sum_{l}(-1)^l\J_{l0}\sum_{l',m'_+}\Bigg\{ \\
&\bigg[(i\x + \y)(l'-m'+1)\chi_{l0l'm'}^{+-}\\
&+(i\x-\y)(l'+m'+1)\chi_{l0l'm'}^{++} +2im'\z \chi_{l0l'm'}^{+0}\bigg]\\
&+\bigg[(-i\x - \y)(l'+m'+1){\chi_{l0l'm'}^{++}}^*\\
&+(-i\x+\y)(l'-m'+1){\chi_{l0l'm'}^{+-}}^* -2im'\z {\chi_{l0l'm'}^{+0}}^*\bigg]\Bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{l}(-1)^l\J_{l0}\sum_{l',m'_+}\bigg\{ \\
&\Re[(i\x + \y)(l'-m'+1)\chi_{l0l'm'}^{+-}]\\
&+\Re[(i\x-\y)(l'+m'+1)\chi_{l0l'm'}^{++}]\\
&-2m'\z \Im\chi_{l0l'm'}^{+0}\bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{l}(-1)^l\J_{l0}\sum_{l',m'_+}\bigg\{ \\
&\y\Re\chi_{l0l'm'}^{+-}(l'-m'+1) - \x\Im\chi_{l0l'm'}^{+-}(l'-m'+1)\\
&-\y\Re\chi_{l0l'm'}^{++}(l'+m'+1) - \x\Re\chi_{l0l'm'}^{++}(l'+m'+1)\\
&-2m'\z \Im\chi_{l0l'm'}^{+0}\bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_d = &\sum_{l}(-1)^l\J_{l0}\sum_{l',m'_+}\bigg\{ \\
&\x\Im\parens{\chi_{l0l'm'}^{+-}(l'-m'+1) +\chi_{l0l'm'}^{++}(l'+m'+1)}\\
&+\y\Re\parens{\chi_{l0l'm'}^{++}(l'+m'+1)-\chi_{l0l'm'}^{+-}(l'-m'+1)}\\
&+2m'\z \Im\chi_{l0l'm'}^{+0}\bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_d = &\sum_{l}(-1)^l\J_{l0}\sum_{l',m'_+}\bigg\{ \\
&\x\Im\parens{\chi_{l,0,l',-m'}^{++}(l'-m'+1) +\chi_{l0l'm'}^{++}(l'+m'+1)}\\
&+\y\Re\parens{\chi_{l0l'm'}^{++}(l'+m'+1)+\chi_{l,0,l',-m'}^{++}(l'-m'+1)}\\
&+m'\z \Im\chi_{l0l'm'}^{+0}-m'\z \Im\chi_{l,0,l',-m'}^{+0}\bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_d = &\sum_{l}(-1)^l\sum_{l',m'\neq 0}\bigg\{ \\
&\x\Im\chi_{l0l'm'}^{++}(l'+m'+1)+\y\Re\chi_{l0l'm'}^{++}(l'+m'+1)\\
&+m'\z \Im\chi_{l0l'm'}^{+0}\bigg\}
\end{aligned}
\end{equation*}
So in all,
\begin{equation*}
\begin{aligned}
\bm \tau_d = &-\sum_{lm}(-1)^l\sum_{l'}(l'+1)\Bigg\{\x\Im\chi_{lml'0}^{--} - \y\Re\chi_{lml'0}^{++}\Bigg\}+\\
 &\sum_{l}(-1)^l\sum_{l',m'\neq 0}\bigg\{ \\
&\x\Im\chi_{l0l'm'}^{++}(l'+m'+1)+\y\Re\chi_{l0l'm'}^{++}(l'+m'+1)\\
&+m'\z \Im\chi_{l0l'm'}^{+0}\bigg\}.
\end{aligned}
\end{equation*}
When the limits are extended to $m_-,m'_- \cup m\geq 0, m' \geq 0$, the off diagonal formula reduces to
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\sum_{l'}\sum_{l,m\geq0}(-1)^l(l'+1)\Bigg\{\\
&\x \Im\bigg(\chi_{lml'0}^{++} + \chi_{lml'0}^{--}\bigg)+\y \Re\bigg(\chi_{lml'0}^{++} + \chi_{lml'0}^{--}\bigg)\Bigg\}\\
&+\sum_{l}(-1)^l\sum_{l',m'>0}\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{l0l'm'}^{++} + (l'-m'+1)\chi_{l0l'm'}^{--}\bigg)\\
&+\y \Re\bigg((l'+m'+1)\chi_{l0l'm'}^{++} + (l'-m'+1)\chi_{l0l'm'}^{--}\bigg)\\
&+m'\z\Im\bigg(\chi_{l0l'm'}^{+0}+\chi_{l0l'm'}^{-0}\bigg)\Bigg\}
\end{aligned}
\end{equation*}
\begin{equation*}
\begin{aligned}
\bm \tau_o = &\sum_{l'}\sum_{l,m\geq0}(-1)^l(l'+1)\Bigg\{\\
&\x \Im\bigg(-\chi_{l,-m,l',0}^{--} + \chi_{lml'0}^{--}\bigg)+\y \Re\bigg(\chi_{lml'0}^{++} + \chi_{l,-m,l',0}^{++}\bigg)\Bigg\}\\
&+\sum_{l}(-1)^l\sum_{l',m'>0}\Bigg\{\\
&\x \Im\bigg((l'+m'+1)\chi_{l0l'm'}^{++} + (l'+m'+1)\chi_{l,0,l',-m'}^{-+}\bigg)\\
&+\y \Re\bigg((l'+m'+1)\chi_{l0l'm'}^{++} - (l'+m'+1)\chi_{l,0,l',-m'}^{-+}\bigg)\\
&+m'\z\Im\bigg(\chi_{l0l'm'}^{+0}+\chi_{l0l'm'}^{-0}\bigg)\Bigg\}
\end{aligned}
\end{equation*}
\comment{So it doesn't really work out. I'll have to do this later.}


\clearpage


\section{Moment of inertia}
The moment of inertia matrix of an object is written as
$$I_{xx}=\int d^3 r \rho(\bm r) (y^2 + z^2), \indent \dots$$
$$I_{xy}=-\int d^3 r \rho(\bm r) xy, \indent \dots.$$
Note that
$$x^2=r^2\brackets{-\frac{1}{3}(Y_{20}-1)+2Y_{2,-2}+\frac{1}{12}Y_{22}}$$
$$y^2=r^2\brackets{-\frac{1}{3}(Y_{20}-1)-2Y_{2,-2}-\frac{1}{12}Y_{22}}$$
$$z^2=r^2\brackets{\frac{2}{3}Y_{20}+\frac{1}{3}}$$
$$xz=r^2\brackets{\frac{Y_{21}}{6}-Y_{2,-1}}$$
$$yz=r^2\brackets{\frac{Y_{21}}{6i}+\frac{Y_{2,-1}}{i}}$$
$$xy=r^2\brackets{\frac{Y_{22}}{12i}-2\frac{Y_{2,-2}}{i}}.$$
Then we can write the above in terms of $R_{2m}$:
$$I_{xx}=\int d^3r \rho(\bm r)-\frac{1}{3}(2R_{20}-1)+2R_{2,-2}+2R_{22}$$
$$I_{yy}=\int d^3r \rho(\bm r)-\frac{1}{3}(2R_{20}-1)-2R_{2,-2}-2R_{22}$$
$$I_{zz}=\int d^3r \rho(\bm r)\frac{4}{3}R_{20}+\frac{1}{3}$$
$$I_{xz}=-\int d^3r \rho(\bm r)R_{21}-R_{2,-1}$$
$$I_{yz}=-\int d^3r \rho(\bm r)\frac{R_{21}+R_{2,-1}}{i}$$
$$I_{xy}=-\int d^3r \rho(\bm r)2\frac{R_{22}-R_{2,-2}}{i}$$
and therefore
$$I_{xx}=\frac{2}{3}\K_{20}-2\K_{2,-2}-2\K_{22}+\frac{2}{5}\K_{00}$$
$$I_{yy}=\frac{2}{3}\K_{20}+2\K_{2,-2}+2\K_{22}+\frac{2}{5}\K_{00}$$
$$I_{zz}=-\frac{4}{3}\K_{20} + \frac{2}{5}\K_{00}$$
$$I_{xz}=\K_{21}-\K_{2,-1}$$
$$I_{yz}=\frac{\K_{21}+\K_{2,-1}}{i}$$
$$I_{xy}=-2\frac{\K_{22}-\K_{2,-2}}{i}.$$

Thus, the moment of inertia is determined entirely by $\K_{lm}$ and therefore by $C_{lms}$. The reader will notice that the moment of inertia depends counter-intuitively on the asteroid mass $\K_{00}$. However, we may write the moment of inertia as $I_\perp+\mathbb{I}\frac{2}{5}\K_{00}$, where $\mathbb{I}$ is the identity matrix, and $I_\perp$ depends only on $K_{2m}$. Then equation $$\dot{\bm \omega} = I^{-1}\parens{\bm \tau - \bm \omega \times \parens{I_\perp+\mathbb{I}\frac{2}{5}\K_{00}} \bm \omega}$$
$$\dot{\bm \omega} = I^{-1}\parens{\bm \tau - \bm \omega \times I_\perp\bm \omega}$$
because the identity matrix does not change the direction of a vector multiplied by it. However, due to the first term, the mass of the asteroid must indeed be known to integrate the equation of motion.



\section{Computing torque}
Since the proof that our torque in equation \ref{eqn:complex-torque} is real is generally difficult and does not seem very enlightening, we will move on for now.

Note that the $S$ present in equation \ref{eqn:complex-torque} forces $l$ and $l'$ to be low in the dominant terms. However, $l'=0$ contributes nothing to torque, nor does $l'=1$ due to the fact that $\K_{1m}=0$, which is caused by $\K_{lm}$ being centered on the center of mass of the asteroid. Therefore, $l'=2$ is the minimum value, and the dominant torque term is proportional to $D^{-3}$.

Note that $\K_{lm}$ are constants, since we are using coordinates fixed to the body. Our derivation requires that we use the same coordinates for $\J_{lm}$, which are therefore not constant. We can find their values at any point in the orbit using the \href{https://en.wikipedia.org/wiki/Wigner_D-matrix#Relation_to_spherical_harmonics_and_Legendre_polynomials}{Wigner-$D$ matrices}, which rotate spherical harmonics according to
$$Y_{lm}(\bm r') = \sum_{m'=-l}^l\sqrt{\frac{(l+m)!}{(l-m)!}\frac{(l-m')!}{(l+m')!}}\parens{D^l_{mm'}(\R}^*Y_{lm'}(\bm r),$$
where $\R$ indicates a rotation, and $\bm r' = \R \bm r$. Generally, $\R$ is represented by Euler angles.

Let $\R$ rotate from the body-fixed axes to some inertial coordinate system. We choose this coordinate system so that the orbit of the asteroid lies in the $xz$-plane, but the exact orientation of the axes is left to the reader. The constants $\J_{lm}$ are then fixed in this frame at $\J_{lm}^0$. Then we must rotate both the $\J_{lm}$ in equation \ref{eqn:complex-torque} according to
\begin{equation*}
\begin{aligned}
\J^\text{rot}_{lm} =&\sum_{m'=-l}^l\sqrt{\frac{(l-m')!}{(l-m)!}\frac{(l+m')!}{(l+m)!}}\parens{D^l_{mm'}(t)}^*\J_{lm'}.
\end{aligned}
\end{equation*}
Thus, equation \ref{eqn:complex-torque} becomes
\begin{equation*}
\begin{aligned}
\bm \tau = &-\frac{1}{2}\sum_{lm}(-1)^l\sum_{l'm'}S_{l+l',m+m'}(\bm D)\\
&\brackets{\sum_{m''=-l}^l\sqrt{\frac{(l-m'')!}{(l-m)!}\frac{(l+m'')!}{(l+m)!}}\parens{D^l_{mm''}(\R)}^*\J_{lm''}^0}\\
&\bigg[(i\x + \y)(l'-m'+1)\K^*_{l',m'-1}\\
&+(i\x-\y)(l'+m'+1)\K^*_{l',m'+1}+2im'\z \K^*_{l'm'}\bigg].
\label{eqn:torque-final}
\end{aligned}
\end{equation*}
The only value left unfixed is the body-fixed coordinate system. We fix it to the principal axes of the asteroid, so that $\z$ aligns with the axis with maximal inertia. Then $\bm\omega = \omega \z$ initially in the body-fixed system. Now everything is determined; the choice of $\J_{lm}$ determines position and velocity $\bm D$ and $\bm v$ which evolve via the linear equation of motion, equation \ref{eqn:linear-eom}. The body's initial orientation--unknown when the spin axis has not been resolved and known up to a roll parameter when the spin axis is resolved---fixes the initial orientation, represented by $\R$. The orientation and angular velocity $\omega$ then evolve according to equation \ref{eqn:euler}, which references the torque displayed in equation \ref{eqn:torque-final}.

In practice, we represent the orientation as a quaternion $\bm q$ and evolve it according to the quaternion equation of motion
$$\dot {\bm q} = \frac{1}{2}\bm \omega \bm q$$
and we extract Euler angles from it to get $\R$, and a matrix from it to convert $\bm D$. from the inertial axes to the body-fixed system.

A benefit to requiring that the body-fixed system be aligned with principal axes is that, in this regime, equation \ref{eqn:euler} simplifies to
\begin{equation}
\begin{aligned}
\dot \omega_x = I_x^{-1}\parens{\tau_x + (I_y - I_z)\omega_y \omega_z}\\
\dot \omega_y = I_y^{-1}\parens{\tau_y + (I_z - I_x)\omega_z \omega_x}\\
\dot \omega_z = I_z^{-1}\parens{\tau_z + (I_x - I_y)\omega_x \omega_y}\\
\end{aligned}
\end{equation}
and the inertial matrix is diagonal, meaning that
$$\K_{21} = \K_{2,-1}=\Im K_{22} = \Im K_{2,-2}= 0.$$
The only free parameters with $l\leq 2$ are $\K_{00}$, $\K_{20}$, and $\Re \K_{22}$, which is three total.



\section{Evolution of Euler Angles}
The Wigner-$D$ matrices are commonly expressed in terms of the Euler angles, so we will use these to track the evolution of the body. Let us use $z-y-z$ Euler angles, or $\bm E = (\alpha, \beta, \gamma)$, with
\begin{equation}
\R = R_z(\alpha) R_y(\beta) R_z(\gamma)
\label{eqn:euler-angle-rotation}
\end{equation}
where $R_z$ and $R_y$ represent right-handed rotations around the $\z$ and $\y$ axes respectively. These angles control the orientation of the asteroid, so we need an equation of motion to describe them.

By definition of angular velocity, we know $\frac{d}{dt}(\R \bm v) = \bm \omega \times \bm v,$ where $\bm v$ is any constant vector, and therefore $\dot \R \bm v = \bm \omega \times \bm v,$. Let $\omega_{\times}$ be the skew-symmetric matrix for $\omega$, such that $\omega_{\times} \bm v = \bm\omega \times \bm v$. Then $\dot \R \bm v = \omega_\times \bm v$. Since this is true for all $\bm v$, we see that $\dot \R = \omega_\times$, or
$$\frac{d}{dt}\parens{R_z(\alpha)R_y(\beta)R_z(\gamma)} = \parens{\begin{matrix}
0 & -\omega_z & \omega_y \\
\omega_z & 0 & -\omega_x \\
-\omega_y & \omega_x & 0
 \end{matrix}}.$$
 This is
 $$\dot \alpha \dot R_z(\alpha)R_y(\beta)R_z(\gamma) + \dot \beta R_z(\alpha)\dot R_y(\beta)R_z(\gamma) + \dot \gamma R_z(\alpha)R_y(\beta)\dot R_z(\gamma) = \parens{\begin{matrix}
 0 & -\omega_z & \omega_y \\
 \omega_z & 0 & -\omega_x \\
 -\omega_y & \omega_x & 0
  \end{matrix}}.$$
  This looks hard, so instead, I suggest using the old Quaternion strategy.




\bibliography{../asteroid-flybys.bib}
\end{document}
